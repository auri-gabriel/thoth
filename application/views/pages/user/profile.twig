{% extends "layout.twig" %}
{% block title %}
	Thoth - Profile
{% endblock %}
{% block content %}
	<section class="profile-section py-5">
		<div class="container">
			<div class="row justify-content-center">
				<div class="col-12 col-md-8 col-lg-6">
					<div class="card shadow-sm">
						<div class="card-header bg-white text-center">
							<h2 class="fw-bold mb-0">Profile:
								{{ session.name|e }}</h2>
						</div>
											<div class="card-body p-4">
												{# Basic Info Form #}
												<h4 class="mb-3">Basic Information</h4>
												{% if session.flashdata('basic_info_success') %}
													<div class="alert alert-success">{{ session.flashdata('basic_info_success') }}</div>
												{% endif %}
												{% if session.flashdata('basic_info_error') %}
													<div class="alert alert-danger">{{ session.flashdata('basic_info_error') }}</div>
												{% endif %}
												{{ form_open('user/update_basic_info', {'class': 'form-profile', 'autocomplete': 'off'})|raw }}
													<div class="mb-3">
														{{ form_label('Name', 'name', {'class': 'form-label'})|raw }}
														{{ form_input({'name': 'name', 'id': 'name', 'class': 'form-control form-control-lg', 'type': 'text', 'placeholder': 'Name', 'required': 'required'}, set_value('name', user.name))|raw }}
														{{ form_error('name', '<div class="text-danger">', '</div>')|raw }}
													</div>
													<div class="mb-3">
														{{ form_label('Email address', 'email', {'class': 'form-label'})|raw }}
														{{ form_input({'name': 'email', 'id': 'email', 'class': 'form-control form-control-lg', 'type': 'email', 'placeholder': 'Enter email', 'required': 'required'}, set_value('email', user.email))|raw }}
														{{ form_error('email', '<div class="text-danger">', '</div>')|raw }}
													</div>
													<div class="d-grid gap-2">
														{{ form_submit({'class': 'btn btn-primary btn-lg'}, 'Update Basic Info')|raw }}
													</div>
												{{ form_close()|raw }}

												<hr class="my-4">

												{# Password Form #}
												<h4 class="mb-3">Change Password</h4>
												{% if session.flashdata('password_success') %}
													<div class="alert alert-success">{{ session.flashdata('password_success') }}</div>
												{% endif %}
												{% if session.flashdata('password_error') %}
													<div class="alert alert-danger">{{ session.flashdata('password_error') }}</div>
												{% endif %}
												{{ form_open('user/update_password', {'class': 'form-password', 'autocomplete': 'off'})|raw }}
													<div class="row mb-3">
														<div class="col-md-6">
															{{ form_label('Current Password', 'current_password', {'class': 'form-label'})|raw }}
															{{ form_password({'name': 'current_password', 'id': 'current_password', 'class': 'form-control form-control-lg', 'placeholder': 'Current Password', 'autocomplete': 'off'})|raw }}
															{{ form_error('current_password', '<div class="text-danger">', '</div>')|raw }}
														</div>
														<div class="col-md-6">
															{{ form_label('New Password', 'new_password', {'class': 'form-label'})|raw }}
															{{ form_password({'name': 'new_password', 'id': 'new_password', 'class': 'form-control form-control-lg', 'placeholder': 'New Password', 'autocomplete': 'off'})|raw }}
															{{ form_error('new_password', '<div class="text-danger">', '</div>')|raw }}
														</div>
													</div>
													<div class="row mb-3">
														<div class="col-md-6">
															{{ form_label('Confirm Password', 'confirm_password', {'class': 'form-label'})|raw }}
															{{ form_password({'name': 'confirm_password', 'id': 'confirm_password', 'class': 'form-control form-control-lg', 'placeholder': 'Confirm Password', 'autocomplete': 'off'})|raw }}
															{{ form_error('confirm_password', '<div class="text-danger">', '</div>')|raw }}
														</div>
													</div>
													<div class="d-grid gap-2">
														{{ form_submit({'class': 'btn btn-warning btn-lg'}, 'Change Password')|raw }}
													</div>
												{{ form_close()|raw }}

												<hr class="my-4">

												{# Institution/Lattes Form #}
												<h4 class="mb-3">Institution & Lattes</h4>
												{% if session.flashdata('institution_success') %}
													<div class="alert alert-success">{{ session.flashdata('institution_success') }}</div>
												{% endif %}
												{% if session.flashdata('institution_error') %}
													<div class="alert alert-danger">{{ session.flashdata('institution_error') }}</div>
												{% endif %}
												{{ form_open('user/update_institution_lattes', {'class': 'form-institution', 'autocomplete': 'off'})|raw }}
													<div class="row mb-3">
														<div class="col-md-6">
															{{ form_label('Institution', 'institution', {'class': 'form-label'})|raw }}
															{{ form_input({'name': 'institution', 'id': 'institution', 'class': 'form-control form-control-lg', 'type': 'text', 'placeholder': 'Institution'}, set_value('institution', user.institution))|raw }}
															{{ form_error('institution', '<div class="text-danger">', '</div>')|raw }}
														</div>
														<div class="col-md-6">
															{{ form_label('Lattes Link', 'lattes_link', {'class': 'form-label'})|raw }}
															{{ form_input({'name': 'lattes_link', 'id': 'lattes_link', 'class': 'form-control form-control-lg', 'type': 'text', 'placeholder': 'Lattes Link'}, set_value('lattes_link', user.lattes_link))|raw }}
															{{ form_error('lattes_link', '<div class="text-danger">', '</div>')|raw }}
														</div>
													</div>
													<div class="d-grid gap-2">
														{{ form_submit({'class': 'btn btn-success btn-lg'}, 'Update Institution & Lattes')|raw }}
													</div>
												{{ form_close()|raw }}
											</div>
					</div>
				</div>
			</div>
		</div>
	</section>
{% endblock %}
